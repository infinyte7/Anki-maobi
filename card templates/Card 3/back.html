<div id="char_zhuyin">{{Zhuyin}}</div>
<div id="char_pinyin">{{Pinyin}}</div>
<div id="char_sim" class="char-card">{{Simplified}}</div>
<div id="char_trad" class="char-card">{{Traditional}}</div>
<div id='audio' style='display:none'>{{Audio}}</div>

<div class="modal-footer1">
    <a class="btn" id="btnShowMenu" onclick="openSidebar('sidebar')">
        <div class="icon">
            <i class="material-icons">menu</i>
        </div>
    </a>
    <a class="btn" id='btnPlayAudio'>
        <div class="icon">
            <i class="material-icons">play_arrow</i>
        </div>
    </a>
    <a class="btn" id='btnMoreOptions' onclick="openSidebar('more-info-sidebar')">
        <div class="icon">
            <i class="material-icons">more_vert</i>
        </div>
    </a>
</div>

<hr>

<div id="char_meaning" class="meaning-card">{{Meaning}}</div>

<script>
    // v1.0.0 - https://github.com/SimonLammer/anki-persistence/blob/eeb2e1a9e37c941dd63e1fe6c2a257f043c40e0d/script.js
    if(void 0===window.Persistence){var _persistenceKey="github.com/SimonLammer/anki-persistence/",_defaultKey="_default";if(window.Persistence_sessionStorage=function(){var e=!1;try{"object"==typeof window.sessionStorage&&(e=!0,this.clear=function(){for(var e=0;e<sessionStorage.length;e++){var t=sessionStorage.key(e);0==t.indexOf(_persistenceKey)&&(sessionStorage.removeItem(t),e--)}},this.setItem=function(e,t){null==t&&(t=e,e=_defaultKey),sessionStorage.setItem(_persistenceKey+e,JSON.stringify(t))},this.getItem=function(e){return null==e&&(e=_defaultKey),JSON.parse(sessionStorage.getItem(_persistenceKey+e))},this.removeItem=function(e){null==e&&(e=_defaultKey),sessionStorage.removeItem(_persistenceKey+e)})}catch(e){}this.isAvailable=function(){return e}},window.Persistence_windowKey=function(e){var t=window[e],n=!1;"object"==typeof t&&(n=!0,this.clear=function(){t[_persistenceKey]={}},this.setItem=function(e,n){null==n&&(n=e,e=_defaultKey),t[_persistenceKey][e]=n},this.getItem=function(e){return null==e&&(e=_defaultKey),null==t[_persistenceKey][e]?null:t[_persistenceKey][e]},this.removeItem=function(e){null==e&&(e=_defaultKey),delete t[_persistenceKey][e]},null==t[_persistenceKey]&&this.clear()),this.isAvailable=function(){return n}},window.Persistence=new Persistence_sessionStorage,Persistence.isAvailable()||(window.Persistence=new Persistence_windowKey("py")),!Persistence.isAvailable()){var titleStartIndex=window.location.toString().indexOf("title"),titleContentIndex=window.location.toString().indexOf("main",titleStartIndex);titleStartIndex>0&&titleContentIndex>0&&titleContentIndex-titleStartIndex<10&&(window.Persistence=new Persistence_windowKey("qt"))}}
</script>    

<!--sidebar-->
<script>
    function completeAudio() {
        var audioDiv = document.getElementById('audio');
        var audio = audioDiv.getElementsByTagName("*");
        audio[0].click();
    }

    document.getElementById("btnPlayAudio").onclick = function () {
        completeAudio();
    };

    var frontBack = "back";
    var switchIdList = ["text-pinyin", "text-zhuyin", "text-meaning", "text-sim", "text-trad"];
    function initSwitchPrefs() {
        for (var _id of switchIdList) {
            var perId = frontBack + _id;
            var divId = _id.replace("text-", "char_");
            if (Persistence.getItem(perId) == "false") {
                document.getElementById(_id).checked = false;
                document.getElementById(divId).style.display = "none";
            } else {
                document.getElementById(_id).checked = true;
                Persistence.setItem(perId, "true");
                document.getElementById(divId).style.display = "block";
            }

            var isShow = document.getElementById(_id).checked ? true : false;
            if (_id == "text-pinyin") {
                showHide(".pinyin", isShow);
            }
            if (_id == "text-zhuyin") {
                showHide(".zhuyin", isShow);
            }
            if (_id == "text-sim") {
                showHide("#char-sim-id", isShow);
            }
            if (_id == "text-trad") {
                showHide("#char-trad-id", isShow);
                showHide(".sep", isShow);
            }
        }
    }

    function setPrefs(e) {
        var perId = frontBack + e.id;
        if (e.type == "checkbox") {
            Persistence.setItem(perId, e.checked.toString());
            var divId = e.id.replace("text-", "char_");
            if (e.checked) {
                document.getElementById(divId).style.display = "block";
            } else {
                document.getElementById(divId).style.display = "none";
            }

            var isShow = document.getElementById(divId).style.display == "none" ? false : true;
            if (e.id == "text-pinyin") {
                showHide(".pinyin", isShow);
            }
            if (e.id == "text-zhuyin") {
                showHide(".zhuyin", isShow);
            }
            if (e.id == "text-sim") {
                showHide("#char-sim-id", isShow);
            }
            if (e.id == "text-trad") {
                showHide("#char-trad-id", isShow);
                showHide(".sep", isShow);
            }
        }
    }

    function showHide(type, isShow) {
        if (isShow) {
            document.querySelectorAll(type).forEach(function (val) {
                val.style.display = 'inline';
            });
        } else {
            document.querySelectorAll(type).forEach(function (val) {
                val.style.display = 'none';
            });
        }
    }

    function openSidebar(id) {
        var width = id == "sidebar" ? "250px" : "160px";
        document.getElementById(id).style.width = width;
    }

    function closeSidebar(id) {
        document.getElementById(id).style.width = "0";
    }

    document.addEventListener('click', function (event) {
        if (!document.getElementById("sidebar") || !document.getElementById("more-info-sidebar")) { return };

        if (!document.getElementById("sidebar").contains(event.target)) {
            closeSidebar("sidebar");
        }

        if (!document.getElementById("more-info-sidebar").contains(event.target)) {
            closeSidebar("more-info-sidebar");
        }

        if (document.getElementById("btnShowMenu").contains(event.target)) {
            openSidebar("sidebar");
        }

        if (document.getElementById("btnMoreOptions").contains(event.target)) {
            openSidebar("more-info-sidebar");
        }
    });

    if (Persistence.isAvailable()) {
        if (window.ankiPlatform == "desktop" || isInWebView()) {
            initSwitchPrefs();
        } else {
            window.addEventListener("load", initSwitchPrefs, false);
        }
    }
</script>

<div id="sidebar" class="sidebar">
    <section>
        <fieldset style="border:none;">
            <div class="fieldset-item">
                <div class="input-stack" style="text-align:center; color: var(--text2);">
                    <label for="deck-title">
                        <h3>xie hanzi</h3>
                    </label>
                </div>
            </div>
        </fieldset>
    </section>

    <section>
        <fieldset>
            <div class="fieldset-item fs-item-1">
                <div class="input-stack">
                    <label for="text-pinyin">
                        Pinyin
                    </label>
                </div>
                <input type="checkbox" id="text-pinyin" name="text-pinyin" onchange=setPrefs(this)>
            </div>

            <div class="fieldset-item fs-item-1">
                <div class="input-stack">
                    <label for="text-zhuyin">
                        Zhuyin
                    </label>
                </div>
                <input type="checkbox" id="text-zhuyin" name="text-zhuyin" onchange=setPrefs(this)>
            </div>

            <div class="fieldset-item fs-item-1">
                <div class="input-stack">
                    <label for="text-meaning">
                        Meaning
                    </label>
                </div>
                <input type="checkbox" id="text-meaning" name="text-meaning" onchange=setPrefs(this)>
            </div>

            <div class="fieldset-item fs-item-1">
                <div class="input-stack">
                    <label for="text-sim">
                        Simplified
                    </label>
                </div>
                <input type="checkbox" id="text-sim" name="text-sim" onchange=setPrefs(this)>
            </div>

            <div class="fieldset-item fs-item-1">
                <div class="input-stack">
                    <label for="text-trad">
                        Traditional
                    </label>
                </div>
                <input type="checkbox" id="text-trad" name="text-trad" onchange=setPrefs(this)>
            </div>
        </fieldset>
    </section>

    <section>
        <fieldset>
            <a href="https://github.com/krmanik/Anki-xiehanzi">
                <div class="fieldset-item">
                    <span style="font-size:14px; text-align:center;">View it on GitHub</span>
                </div>
            </a>
        </fieldset>
    </section>
</div>

<div id="more-info-sidebar" class="more-info-sidebar">
    <a class="fieldset-item" id="plecoMobile" href="plecoapi://x-callback-url/df?hw={{Simplified}}">
        <img src="_pleco.png"></img>
        <small>Pleco</small>
    </a>
    <a class="fieldset-item" href="http://dict.youdao.com/search?q={{Simplified}}">
        <img src="_youdao.png"></img>
        <small>Youdao</small>
    </a>
    <a class="fieldset-item" href="https://hanzicraft.com/character/{{Simplified}}">
        <img src="_hanzicraft.png"></img>
        <small>HanziCraft</small>
    </a>
    <a class="fieldset-item" href="https://characterpop.com/characters/{{Simplified}}">
        <img src="_characterpop.svg"></img>
        <small>CharacterPop</small>
    </a>
    <a class="fieldset-item" href="http://rtega.be/chmn/index.php?c={{Simplified}}">
        <img src="_rtega.png"></img>
        <small>Rtega</small>
    </a>
    <a class="fieldset-item" href="https://tatoeba.org/en/sentences/search?from=cmn&query={{Simplified}}&to=">
        <img src="_tatoeba.png"></img>
        <small>Tatoeba</small>
    </a>
</div>
<!-----sidebar------>